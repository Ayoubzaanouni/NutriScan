from flask import Flask
from flask import request
import json

app = Flask(__name__)

@app.route('/',methods=['GET','POST'])
def hello_world():
    barcode = str(request.args.get('barcode'))
    country = get_country_name(barcode)

    data_set = {'country': country}
    json_dump = json.dumps(data_set)
    return json_dump

def get_country_name(barcode_data):
    if len(barcode_data) == 13 or len(barcode_data) == 8:
        country_code_1 = int(barcode_data[0:1])
        if country_code_1 == 0:
            return "United States and Canada"
        elif country_code_1 == 1:
            return "USA"

        country_code_2 = int(barcode_data[0:2])
        country_2 = country_2_digit_codes.get(country_code_2, "Unknown Country")

        if country_2 == "Unknown Country":
            country_code_3 = int(barcode_data[0:3])
            country_3 = country_3_digit_codes.get(country_code_3, "Unknown Country")
            return country_3
        else:
            return country_2


country_2_digit_codes = {
            30: "France",
            31: "France",
            32: "France",
            33: "France",
            34: "France",
            35: "France",
            36: "France",
            37: "France",
            40: "Germany",
            44: "United Kingdom",
            45: "Japan",
            49: "Japan",
            46: "Russian Federation",
            47: "Taiwan",
            50: "United Kingdom",
            54: "Belgium and Luxembourg",
            64: "Finland",
            69: "China",
            70: "Norway",
            73: "Sweden",
            87: "Netherlands",
            90: "Austria",
            91: "Austria",
            93: "Australia",
            94: "New Zealand",
}

country_3_digit_codes = {
            383: "Slovenija",
            385: "Croatia",
            387: "Bosnia and Herzegovina",
            389: "Montenegro",
            390: "Kosovo",
            470: "Kyrgyzstan",
            471: "Taiwan",
            474: "Estonia",
            380: "Bulgaria",
            475: "Latvia",
            476: "Azerbaijan",
            477: "Lithuania",
            478: "Uzbekistan",
            479: "Sri Lanka",
            480: "Philippines",
            481: "Belarus",
            482: "Ukraine",
            483: "Turkmenistan",
            484: "Moldova",
            485: "Armenia",
            486: "Georgia",
            487: "Kazakhstan",
            488: "Tajikistan",
            489: "Hong Kong",
            520: "Greece",
            521: "Greece",
            528: "Lebanon",
            529: "Cyprus",
            530: "Albania",
            531: "Macedonia",
            535: "Malta",
            539: "Ireland",
            560: "Portugal",
            569: "Iceland",
            570: "Denmark",
            590: "Poland",
            594: "Romania",
            599: "Hungary",
            600: "South Africa",
            601: "South Africa",
            602: "Benin",
            603: "Ghana",
            604: "Senegal",
            608: "Bahrain",
            609: "Mauritius",
            611: "Morocco",
            613: "Algeria",
            616: "Kenya",
            618: "CÃ´te d'Ivoire",
            619: "Tunisia",
            620: "Tanzania",
            621: "Syria",
            622: "Egypt",
            623: "Brunei Darussalam",
            624: "Libya",
            625: "Jordan",
            626: "Iran",
            627: "Kuwait",
            628: "Saudi Arabia",
            629: "United Arab Emirates",
            729: "Israel",
            871: "Israel",
            740: "Guatemala",
            741: "El Salvador",
            742: "Honduras",
            743: "Nicaragua",
            744: "Costa Rica",
            745: "Panama",
            746: "Dominican Republic",
            750: "Mexico",
            759: "Venezuela",
            761: "Switzerland",
            770: "Colombia",
            771: "Colombia",
            773: "Uruguay",
            775: "Peru",
            777: "Bolivia",
            779: "Argentina",
            780: "Chile",
            784: "Paraguay",
            786: "Ecuador",
            789: "Brazil",
            790: "Brazil",
            800: "Italy",
            801: "Italy",
            802: "Italy",
            803: "Italy",
            804: "Italy",
            805: "Italy",
            806: "Italy",
            807: "Italy",
            808: "Italy",
            809: "Italy",
            810: "Italy",
            811: "Italy",
            812: "Italy",
            813: "Italy",
            814: "Italy",
            815: "Italy",
            816: "Italy",
            817: "Italy",
            818: "Italy",
            819: "Italy",
            820: "Italy",
            821: "Italy",
            822: "Italy",
            823: "Italy",
            824: "Italy",
            825: "Italy",
            826: "Italy",
            827: "Italy",
            828: "Italy",
            829: "Italy",
            830: "Italy",
            831: "Italy",
            832: "Italy",
            833: "Italy",
            834: "Italy",
            835: "Italy",
            836: "Italy",
            837: "Italy",
            838: "Italy",
            839: "Italy",
            840: "Spain",
            841: "Spain",
            842: "Spain",
            843: "Spain",
            844: "Spain",
            845: "Spain",
            846: "Spain",
            847: "Spain",
            848: "Spain",
            849: "Spain",
            850: "Cuba",
            858: "Slovakia",
            859: "Czech Republic",
            860: "Serbia",
            865: "Mongolia",
            867: "North Korea",
            868: "Turkey",
            869: "Turkey",
            880: "South Korea",
            885: "Thailand",
            888: "Singapore",
            890: "India",
            893: "Vietnam",
            896: "Pakistan",
            899: "Indonesia",
            955: "Malaysia",
            958: "Macau",
        }